上篇文章谈了谈企业应该如何定位RPA技术以及建立卓越中心的一些思考。

本文是个技术文章，谈谈如何用RPA实现SAP GUI中数据导出的并发执行，以缩短RPA的运行时间。

# 一、源起

最近参与了一个RPA的POC，和来自四大的同行（共五家入围POC）一起，针对同一个场景进行可行性实现。

由于总体流程比较清晰，需求就比较简单，而我们RPA团队做项目总是需要追求极致，要有亮点的。

亮点之一便是采用从SAP系统导出原始数据时，采用了并发执行的方式，以提升数据导出的效率，缩短RPA完成整个流程的时间。

# 二、实现总体思路
## 2.1关于SAP系统数据
粗暴的来分，SAP ERP数据在系统中有两种存放方式：实际生成的数据（例如会计分录BSEG表）和需要动态计算的数据（例如科目余额表FS10N）。前者可以通过SE16直接找到透明表导出来，后者则需要有ABAP代码动态计算生成。

数据导出的所需时长取决于：原始数据量、计算复杂度、服务器性能。

## 2.2 数据导出的步骤
步骤1：打开新窗口、输入事务码、输入筛选条件

步骤2：执行数据查询

步骤3：导出结果为Excel

## 2.3 并行原理
在只有一个机器人的情况下，所谓的并行，其实就是多线程。
总体来讲还是串行执行，只是在不同的线程任务之间进行切换。
纯本地化的操作，并行是没有意义的；并行的意义在于让等待远端服务器计算的操作能够同时执行，以节省等待时间。

## 2.4 理想和现实
理想的预期是这样的：
 

现实能够实现是这样的：
 

“理想”和“现实”的差异就在于本来能够节省的两次“导出结果”操作的时间没有能够被有效节省。

对于可能的原因分析：
软件产品的问题：这是一个bug，或者待优化点；
实施人员的问题：对于软件的理解有待加深。
比较倾向于是由于软件产品的问题。

如果您有实现“理想”的方案，跪求思路和方法！

# 三、操作细节
非技术人员不会看到这里，为节省时间，后面的内容就只提问题，答案先空着。想了解细节的，请私信或留言。

## 3.1 需要考虑的问题：
### a. 需要打开SAP GUI支持RPA的开关
### b. 需要有效定位和区分SAP GUI的不同窗口，并行才能可行
### c. RAP软件并行机制要合理设计
